.data
tmp:
  .word 1 # 0x1
  .word 2 # 0x2
  .word 3 # 0x3
  .word 4 # 0x4
  .word 5 # 0x5
  .word 6 # 0x6
  .word 7 # 0x7
  .word 8 # 0x8
  .word 9 # 0x9
  .word 10 # 0xa
  .zero 

tmpp:
  .zero 64

.text
.global main
main: # @main
  addi sp, sp, -32    # encoding: [0x13,0x01,0x01,0xfe] [0x13, 0x1, 0x1, 0xfe]
  sd ra, 24(sp)       # encoding: [0x23,0x3c,0x11,0x00] [0x23, 0x3c, 0x11, 0x0]
  sd fp,16(sp)        # encoding: [0x23,0x38,0x81,0x00] [0x23, 0x38, 0x81, 0x0]
  addi fp, sp, 32     # encoding: [0x13,0x04,0x01,0x02] [0x13, 0x4, 0x1, 0x2]
  sd a1, 8(sp)        # encoding: [0x23,0x34,0xb1,0x00] [0x23, 0x34, 0xb1, 0x0]
  sd a0, 0(sp)        # encoding: [0x23,0x30,0xa1,0x00] [0x23, 0x30, 0xa1, 0x0]

  # T0 = CallContext->stack_size
  ld t0, 512(a1)      # encoding: [0x83,0xb2,0x05,0x20] [0x83,0xb2,0x05,0x20]
  # SP = SP - T0
  sub sp, sp, t0      # encoding: [0x33,0x01,0x51,0x40] [0x33, 0x1, 0x51, 0x40]
  # copy stack from the CallContext,T0 = index, T1 = dest, T2 = source
  addi t1, sp, 0      # encoding: [0x13,0x03,0x01,0x00] [0x13, 0x3, 0x1, 0x0]
# .Lpcrel_hi1:
#   auipc t1, %pcrel_hi(tmpp)
#   addi t1, t1, %pcrel_lo(.Lpcrel_hi1)
  # t2 = CallContext->stack
  ld t2, 520(a1)      # encoding: [0x83,0xb3,0x85,0x20] [0x83,0xb3,0x85,0x20]
# .Lpcrel_hi2:
#   auipc t2, %pcrel_hi(tmp)
#   addi t2, t2, %pcrel_lo(.Lpcrel_hi2)
start_copy:
  beq t0, zero, exit_copy   # encoding: [0x63'A',0x80'A',0x02'A',A] [0x63, 0x8c, 0x2, 0x0] [0x63, 0x8c, 0x2, 0x0] ?  0x63    0x8e    0x02    0x00
  ld t3, 0(t2)        # encoding: [0x03,0xbe,0x03,0x00] [0x3, 0xbe, 0x3, 0x0]
  sd t3, 0(t1)        # encoding: [0x23,0x30,0xc3,0x01] [0x23, 0x30, 0xc3, 0x1]
  addi t1, t1, 8      # encoding: [0x13,0x03,0x83,0x00] [0x13, 0x3, 0x83, 0x0]
  addi t2, t2, 8      # encoding: [0x93,0x83,0x83,0x00] [0x93, 0x83, 0x83, 0x0]
  addi t0, t0, -8     # encoding: [0x93,0x82,0x82,0xff] [0x93, 0x82, 0x82, 0xff]
  jal x0, start_copy  # encoding: [0x6f,0bAAAA0000,A,A] [0x6f, 0xf0, 0x9f, 0xfe]
exit_copy:
  
  addi t0, a1, 0      # encoding: [0x93,0x82,0x05,0x00] [0x93, 0x82, 0x5, 0x0]

  # /* set all general purpose registers from CallContext */
  ld a0, 80(t0)       # encoding: [0x03,0xb5,0x02,0x05] [0x3, 0xb5, 0x2, 0x5]
  ld a1, 88(t0)       # encoding: [0x83,0xb5,0x82,0x05] [0x83, 0xb5, 0x82, 0x5]
  ld a2, 96(t0)       # encoding: [0x03,0xb6,0x02,0x06] [0x3, 0xb6, 0x2, 0x6]
  ld a3, 104(t0)      # encoding: [0x83,0xb6,0x82,0x06] [0x83, 0xb6, 0x82, 0x6]
  ld a4, 112(t0)      # encoding: [0x03,0xb7,0x02,0x07] [0x3, 0xb7, 0x2, 0x7]
  ld a5, 120(t0)      # encoding: [0x83,0xb7,0x82,0x07] [0x83, 0xb7, 0x82, 0x7]
  ld a6, 128(t0)      # encoding: [0x03,0xb8,0x02,0x08] [0x3, 0xb8, 0x2, 0x8]
  ld a7, 136(t0)      # encoding: [0x83,0xb8,0x82,0x08] [0x83, 0xb8, 0x82, 0x8]

  # /* set all floating registers from CallContext  */
  fld fa0, 336(t0)    # encoding: [0x07,0xb5,0x02,0x15] [0x7, 0xb5, 0x2, 0x15]
  fld fa1, 344(t0)    # encoding: [0x87,0xb5,0x82,0x15] [0x87, 0xb5, 0x82, 0x15]
  fld fa2, 352(t0)    # encoding: [0x07,0xb6,0x02,0x16] [0x7, 0xb6, 0x2, 0x16]
  fld fa3, 360(t0)    # encoding: [0x87,0xb6,0x82,0x16] [0x87, 0xb6, 0x82, 0x16]
  fld fa4, 368(t0)    # encoding: [0x07,0xb7,0x02,0x17] [0x7, 0xb7, 0x2, 0x17]
  fld fa5, 376(t0)    # encoding: [0x87,0xb7,0x82,0x17] [0x87, 0xb7, 0x82, 0x17]
  fld fa6, 384(t0)    # encoding: [0x07,0xb8,0x02,0x18] [0x7, 0xb8, 0x2, 0x18]
  fld fa7, 392(t0)    # encoding: [0x87,0xb8,0x82,0x18] [0x87, 0xb8, 0x82, 0x18]

  # /* load target addr */
  # ld t0, 0(sp)
  ld t0, -32(fp)      # encoding: [0x83,0x32,0x04,0xfe] [0x83, 0x32, 0x4, 0xfe]
  jalr t0, 0          # encoding: [0xe7,0x80,0x02,0x00] [0xe7, 0x80, 0x2, 0x0]

  # addi t0, a1, 0 # t0 is CallContext*
  # ld t0, 8(sp)
  ld t0, -24(fp)      # encoding: [0x83,0x32,0x84,0xfe]

  # /* set all general purpose registers to CallContext */
  sd a0, 80(t0)       # encoding: [0x23,0xb8,0xa2,0x04] [0x23, 0xb8, 0xa2, 0x4]
  sd a1, 88(t0)       # encoding: [0x23,0xbc,0xb2,0x04] [0x23, 0xbc, 0xb2, 0x4]
  sd a2, 96(t0)       # encoding: [0x23,0xb0,0xc2,0x06] [0x23, 0xb0, 0xc2, 0x6]
  sd a3, 104(t0)      # encoding: [0x23,0xb4,0xd2,0x06] [0x23, 0xb4, 0xd2, 0x6]
  sd a4, 112(t0)      # encoding: [0x23,0xb8,0xe2,0x06] [0x23, 0xb8, 0xe2, 0x6]
  sd a5, 120(t0)      # encoding: [0x23,0xbc,0xf2,0x06] [0x23, 0xbc, 0xf2, 0x6]
  sd a6, 128(t0)      # encoding: [0x23,0xb0,0x02,0x09] [0x23, 0xb0, 0x2, 0x9]
  sd a7, 136(t0)      # encoding: [0x23,0xb4,0x12,0x09] [0x23, 0xb4, 0x12, 0x9]

  # /* set all floating registers from CallContext  */
  fsd fa0, 336(t0)    # encoding: [0x27,0xb8,0xa2,0x14] [0x27, 0xb8, 0xa2, 0x14]
  fsd fa1, 344(t0)    # encoding: [0x27,0xbc,0xb2,0x14] [0x27, 0xbc, 0xb2, 0x14]
  fsd fa2, 352(t0)    # encoding: [0x27,0xb0,0xc2,0x16] [0x27, 0xb0, 0xc2, 0x16]
  fsd fa3, 360(t0)    # encoding: [0x27,0xb4,0xd2,0x16] [0x27, 0xb4, 0xd2, 0x16]
  fsd fa4, 368(t0)    # encoding: [0x27,0xb8,0xe2,0x16] [0x27, 0xb8, 0xe2, 0x16]
  fsd fa5, 376(t0)    # encoding: [0x27,0xbc,0xf2,0x16] [0x27, 0xbc, 0xf2, 0x16]
  fsd fa6, 384(t0)    # encoding: [0x27,0xb0,0x02,0x19] [0x27, 0xb0, 0x2, 0x19]
  fsd fa7, 392(t0)    # encoding: [0x27,0xb4,0x12,0x19] [0x27, 0xb4, 0x12, 0x19]

  addi sp, fp, 0      # encoding: [0x13,0x01,0x04,0x00] [0x13, 0x1, 0x4, 0x0]
  ld a0, -32(sp)      # encoding: [0x03,0x35,0x01,0xfe] [0x3, 0x35, 0x1, 0xfe]
  ld a1, -24(sp)      # encoding: [0x83,0x35,0x81,0xfe] [0x83, 0x35, 0x81, 0xfe]
  ld fp, -16(sp)      # encoding: [0x03,0x34,0x01,0xff] [0x3, 0x34, 0x1, 0xff]
  ld ra, -8(sp)       # encoding: [0x83,0x30,0x81,0xff] [0x83, 0x30, 0x81, 0xff]
  ret                 # encoding: [0x67,0x80,0x00,0x00] [0x67, 0x80, 0x0, 0x0]


  